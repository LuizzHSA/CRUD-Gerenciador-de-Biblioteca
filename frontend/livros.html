<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Livros Cadastrados</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
    <div class="container mt-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="h3">üìñ Livros Cadastrados</h1>
            <a href="index.html" class="btn btn-primary">‚úèÔ∏è Cadastrar Novo Livro</a>
        </div>

        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>T√≠tulo</th>
                    <th>Autor</th>
                    <th>Editora</th>
                    <th>Ano</th>
                    <th>Qtd</th>
                    <th>A√ß√µes</th>
                </tr>
            </thead>
            <tbody id="tabelaLivros">
                <!-- Os livros ser√£o inseridos aqui -->
            </tbody>
        </table>
    </div>

    <script>
        async function carregarLivros() {
            try {
                const resposta = await fetch('http://localhost:3000/api/livros');
                const livros = await resposta.json();

                const tbody = document.getElementById('tabelaLivros');
                tbody.innerHTML = '';

                livros.forEach(livro => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
            <td>${livro.id}</td>
            <td>${livro.titulo}</td>
            <td>${livro.autor}</td>
            <td>${livro.editora}</td>
            <td>${livro.ano}</td>
            <td>${livro.quantidade}</td>
            <td>
              <button onclick="editarLivro(${livro.id})" class="btn btn-warning btn-sm me-1">‚úèÔ∏è</button>
              <button onclick="deletarLivro(${livro.id})" class="btn btn-danger btn-sm">üóëÔ∏è</button>
            </td>
          `;
                    tbody.appendChild(tr);
                });
            } catch (erro) {
                console.error('Erro ao carregar livros:', erro);
            }
        }

        async function deletarLivro(id) {
            if (!confirm('Tem certeza que deseja deletar este livro?')) return;

            try {
                await fetch(`http://localhost:3000/api/livros/${id}`, {
                    method: 'DELETE'
                });
                alert('Livro deletado com sucesso!');
                carregarLivros();
            } catch (erro) {
                alert('Erro ao deletar livro');
            }
        }

        function editarLivro(id) {
            alert('Fun√ß√£o de edi√ß√£o em constru√ß√£o...');
            // No futuro, aqui pode redirecionar para editar.html?id=ID
        }

        carregarLivros();
    </script>
</body>

</html>